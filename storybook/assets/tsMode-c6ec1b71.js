var ce=Object.defineProperty;var f=(t,e)=>ce(t,"name",{value:e,configurable:!0});import{o as ue}from"./iframe-152c6bd8.js";import{m as ge}from"./Listing.stories-eba67020.js";import"./jsx-runtime-f76f309b.js";import"./index-c41194e7.js";import"./svg-45390b6b.js";import"./PenrosePrograms-7599ae95.js";import"./vector-wedge.substance-f3f6e6e8.js";var se=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,de=Object.getOwnPropertyNames,fe=Object.prototype.hasOwnProperty,he=f(t=>se(t,"__esModule",{value:!0}),"__markAsModule"),be=f((t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of de(e))!fe.call(t,s)&&s!=="default"&&se(t,s,{get:()=>e[s],enumerable:!(r=pe(e,s))||r.enumerable});return t},"__reExport"),i={};he(i);be(i,ge);var x,me=(x=class{constructor(e,r){this._modeId=e,this._defaults=r,this._worker=null,this._client=null,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker()),this._updateExtraLibsToken=0,this._extraLibsChangeListener=this._defaults.onDidExtraLibsChange(()=>this._updateExtraLibs())}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}dispose(){this._configChangeListener.dispose(),this._extraLibsChangeListener.dispose(),this._stopWorker()}async _updateExtraLibs(){if(!this._worker)return;const e=++this._updateExtraLibsToken,r=await this._worker.getProxy();this._updateExtraLibsToken===e&&r.updateExtraLibs(this._defaults.getExtraLibs())}_getClient(){if(!this._client){this._worker=i.editor.createWebWorker({moduleId:"vs/language/typescript/tsWorker",label:this._modeId,keepIdleModels:!0,createData:{compilerOptions:this._defaults.getCompilerOptions(),extraLibs:this._defaults.getExtraLibs(),customWorkerPath:this._defaults.workerOptions.customWorkerPath,inlayHintsOptions:this._defaults.inlayHintsOptions}});let e=this._worker.getProxy();this._defaults.getEagerModelSync()&&(e=e.then(r=>this._worker?this._worker.withSyncedResources(i.editor.getModels().filter(s=>s.getLanguageId()===this._modeId).map(s=>s.uri)):r)),this._client=e}return this._client}getLanguageServiceWorker(...e){let r;return this._getClient().then(s=>{r=s}).then(s=>{if(this._worker)return this._worker.withSyncedResources(e)}).then(s=>r)}},f(x,"WorkerManager"),x),_e="4.4.4",$;(function(t){t[t.None=0]="None",t[t.CommonJS=1]="CommonJS",t[t.AMD=2]="AMD",t[t.UMD=3]="UMD",t[t.System=4]="System",t[t.ES2015=5]="ES2015",t[t.ESNext=99]="ESNext"})($||($={}));var z;(function(t){t[t.None=0]="None",t[t.Preserve=1]="Preserve",t[t.React=2]="React",t[t.ReactNative=3]="ReactNative",t[t.ReactJSX=4]="ReactJSX",t[t.ReactJSXDev=5]="ReactJSXDev"})(z||(z={}));var X;(function(t){t[t.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",t[t.LineFeed=1]="LineFeed"})(X||(X={}));var G;(function(t){t[t.ES3=0]="ES3",t[t.ES5=1]="ES5",t[t.ES2015=2]="ES2015",t[t.ES2016=3]="ES2016",t[t.ES2017=4]="ES2017",t[t.ES2018=5]="ES2018",t[t.ES2019=6]="ES2019",t[t.ES2020=7]="ES2020",t[t.ESNext=99]="ESNext",t[t.JSON=100]="JSON",t[t.Latest=99]="Latest"})(G||(G={}));var Q;(function(t){t[t.Classic=1]="Classic",t[t.NodeJs=2]="NodeJs"})(Q||(Q={}));var C,ie=(C=class{constructor(e,r,s,a){this._onDidChange=new i.Emitter,this._onDidExtraLibsChange=new i.Emitter,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(e),this.setDiagnosticsOptions(r),this.setWorkerOptions(s),this.setInlayHintsOptions(a),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(e,r){let s;if(typeof r>"u"?s=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:s=r,this._extraLibs[s]&&this._extraLibs[s].content===e)return{dispose:()=>{}};let a=1;return this._removedExtraLibs[s]&&(a=this._removedExtraLibs[s]+1),this._extraLibs[s]&&(a=this._extraLibs[s].version+1),this._extraLibs[s]={content:e,version:a},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let c=this._extraLibs[s];c&&c.version===a&&(delete this._extraLibs[s],this._removedExtraLibs[s]=a,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(e){for(const r in this._extraLibs)this._removedExtraLibs[r]=this._extraLibs[r].version;if(this._extraLibs=Object.create(null),e&&e.length>0)for(const r of e){const s=r.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,a=r.content;let c=1;this._removedExtraLibs[s]&&(c=this._removedExtraLibs[s]+1),this._extraLibs[s]={content:a,version:c}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(e){this._compilerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(e){this._workerOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(e){this._inlayHintsOptions=e||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(e){}setEagerModelSync(e){this._eagerModelSync=e}getEagerModelSync(){return this._eagerModelSync}},f(C,"LanguageServiceDefaultsImpl"),C),Se=_e,ee=new ie({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{}),ne=new ie({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{}),ve=f(()=>J().then(t=>t.getTypeScriptWorker()),"getTypeScriptWorker"),we=f(()=>J().then(t=>t.getJavaScriptWorker()),"getJavaScriptWorker");i.languages.typescript={ModuleKind:$,JsxEmit:z,NewLineKind:X,ScriptTarget:G,ModuleResolutionKind:Q,typescriptVersion:Se,typescriptDefaults:ee,javascriptDefaults:ne,getTypeScriptWorker:ve,getJavaScriptWorker:we};function J(){return ue(()=>Promise.resolve().then(()=>He),void 0,import.meta.url)}f(J,"getMode");i.languages.onLanguage("typescript",()=>J().then(t=>t.setupTypeScript(ee)));i.languages.onLanguage("javascript",()=>J().then(t=>t.setupJavaScript(ne)));var o={};o["lib.d.ts"]=!0;o["lib.dom.d.ts"]=!0;o["lib.dom.iterable.d.ts"]=!0;o["lib.es2015.collection.d.ts"]=!0;o["lib.es2015.core.d.ts"]=!0;o["lib.es2015.d.ts"]=!0;o["lib.es2015.generator.d.ts"]=!0;o["lib.es2015.iterable.d.ts"]=!0;o["lib.es2015.promise.d.ts"]=!0;o["lib.es2015.proxy.d.ts"]=!0;o["lib.es2015.reflect.d.ts"]=!0;o["lib.es2015.symbol.d.ts"]=!0;o["lib.es2015.symbol.wellknown.d.ts"]=!0;o["lib.es2016.array.include.d.ts"]=!0;o["lib.es2016.d.ts"]=!0;o["lib.es2016.full.d.ts"]=!0;o["lib.es2017.d.ts"]=!0;o["lib.es2017.full.d.ts"]=!0;o["lib.es2017.intl.d.ts"]=!0;o["lib.es2017.object.d.ts"]=!0;o["lib.es2017.sharedmemory.d.ts"]=!0;o["lib.es2017.string.d.ts"]=!0;o["lib.es2017.typedarrays.d.ts"]=!0;o["lib.es2018.asyncgenerator.d.ts"]=!0;o["lib.es2018.asynciterable.d.ts"]=!0;o["lib.es2018.d.ts"]=!0;o["lib.es2018.full.d.ts"]=!0;o["lib.es2018.intl.d.ts"]=!0;o["lib.es2018.promise.d.ts"]=!0;o["lib.es2018.regexp.d.ts"]=!0;o["lib.es2019.array.d.ts"]=!0;o["lib.es2019.d.ts"]=!0;o["lib.es2019.full.d.ts"]=!0;o["lib.es2019.object.d.ts"]=!0;o["lib.es2019.string.d.ts"]=!0;o["lib.es2019.symbol.d.ts"]=!0;o["lib.es2020.bigint.d.ts"]=!0;o["lib.es2020.d.ts"]=!0;o["lib.es2020.full.d.ts"]=!0;o["lib.es2020.intl.d.ts"]=!0;o["lib.es2020.promise.d.ts"]=!0;o["lib.es2020.sharedmemory.d.ts"]=!0;o["lib.es2020.string.d.ts"]=!0;o["lib.es2020.symbol.wellknown.d.ts"]=!0;o["lib.es2021.d.ts"]=!0;o["lib.es2021.full.d.ts"]=!0;o["lib.es2021.promise.d.ts"]=!0;o["lib.es2021.string.d.ts"]=!0;o["lib.es2021.weakref.d.ts"]=!0;o["lib.es5.d.ts"]=!0;o["lib.es6.d.ts"]=!0;o["lib.esnext.d.ts"]=!0;o["lib.esnext.full.d.ts"]=!0;o["lib.esnext.intl.d.ts"]=!0;o["lib.esnext.promise.d.ts"]=!0;o["lib.esnext.string.d.ts"]=!0;o["lib.esnext.weakref.d.ts"]=!0;o["lib.scripthost.d.ts"]=!0;o["lib.webworker.d.ts"]=!0;o["lib.webworker.importscripts.d.ts"]=!0;o["lib.webworker.iterable.d.ts"]=!0;var te;(function(t){t[t.None=0]="None",t[t.Block=1]="Block",t[t.Smart=2]="Smart"})(te||(te={}));function q(t,e,r=0){if(typeof t=="string")return t;if(t===void 0)return"";let s="";if(r){s+=e;for(let a=0;a<r;a++)s+="  "}if(s+=t.messageText,r++,t.next)for(const a of t.next)s+=q(a,e,r);return s}f(q,"flattenDiagnosticMessageText");function v(t){return t?t.map(e=>e.text).join(""):""}f(v,"displayPartsToString");var L,S=(L=class{constructor(e){this._worker=e}_textSpanToRange(e,r){let s=e.getPositionAt(r.start),a=e.getPositionAt(r.start+r.length),{lineNumber:c,column:d}=s,{lineNumber:p,column:n}=a;return{startLineNumber:c,startColumn:d,endLineNumber:p,endColumn:n}}},f(L,"Adapter"),L),D,ye=(D=class{constructor(e){this._worker=e,this._libFiles={},this._hasFetchedLibFiles=!1,this._fetchLibFilesPromise=null}isLibFile(e){return e&&e.path.indexOf("/lib.")===0?!!o[e.path.slice(1)]:!1}getOrCreateModel(e){const r=i.Uri.parse(e),s=i.editor.getModel(r);if(s)return s;if(this.isLibFile(r)&&this._hasFetchedLibFiles)return i.editor.createModel(this._libFiles[r.path.slice(1)],"typescript",r);const a=ee.getExtraLibs()[e];return a?i.editor.createModel(a.content,"typescript",r):null}_containsLibFile(e){for(let r of e)if(this.isLibFile(r))return!0;return!1}async fetchLibFilesIfNecessary(e){this._containsLibFile(e)&&await this._fetchLibFiles()}_fetchLibFiles(){return this._fetchLibFilesPromise||(this._fetchLibFilesPromise=this._worker().then(e=>e.getLibFiles()).then(e=>{this._hasFetchedLibFiles=!0,this._libFiles=e})),this._fetchLibFilesPromise}},f(D,"LibFiles"),D),re;(function(t){t[t.Warning=0]="Warning",t[t.Error=1]="Error",t[t.Suggestion=2]="Suggestion",t[t.Message=3]="Message"})(re||(re={}));var O,ke=(O=class extends S{constructor(e,r,s,a){super(a),this._libFiles=e,this._defaults=r,this._selector=s,this._disposables=[],this._listener=Object.create(null);const c=f(n=>{if(n.getLanguageId()!==s)return;const g=f(()=>{const{onlyVisible:m}=this._defaults.getDiagnosticsOptions();m?n.isAttachedToEditor()&&this._doValidate(n):this._doValidate(n)},"maybeValidate");let u;const h=n.onDidChangeContent(()=>{clearTimeout(u),u=window.setTimeout(g,500)}),b=n.onDidChangeAttached(()=>{const{onlyVisible:m}=this._defaults.getDiagnosticsOptions();m&&(n.isAttachedToEditor()?g():i.editor.setModelMarkers(n,this._selector,[]))});this._listener[n.uri.toString()]={dispose(){h.dispose(),b.dispose(),clearTimeout(u)}},g()},"onModelAdd"),d=f(n=>{i.editor.setModelMarkers(n,this._selector,[]);const g=n.uri.toString();this._listener[g]&&(this._listener[g].dispose(),delete this._listener[g])},"onModelRemoved");this._disposables.push(i.editor.onDidCreateModel(n=>c(n))),this._disposables.push(i.editor.onWillDisposeModel(d)),this._disposables.push(i.editor.onDidChangeModelLanguage(n=>{d(n.model),c(n.model)})),this._disposables.push({dispose(){for(const n of i.editor.getModels())d(n)}});const p=f(()=>{for(const n of i.editor.getModels())d(n),c(n)},"recomputeDiagostics");this._disposables.push(this._defaults.onDidChange(p)),this._disposables.push(this._defaults.onDidExtraLibsChange(p)),i.editor.getModels().forEach(n=>c(n))}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}async _doValidate(e){const r=await this._worker(e.uri);if(e.isDisposed())return;const s=[],{noSyntaxValidation:a,noSemanticValidation:c,noSuggestionDiagnostics:d}=this._defaults.getDiagnosticsOptions();a||s.push(r.getSyntacticDiagnostics(e.uri.toString())),c||s.push(r.getSemanticDiagnostics(e.uri.toString())),d||s.push(r.getSuggestionDiagnostics(e.uri.toString()));const p=await Promise.all(s);if(!p||e.isDisposed())return;const n=p.reduce((u,h)=>h.concat(u),[]).filter(u=>(this._defaults.getDiagnosticsOptions().diagnosticCodesToIgnore||[]).indexOf(u.code)===-1),g=n.map(u=>u.relatedInformation||[]).reduce((u,h)=>h.concat(u),[]).map(u=>u.file?i.Uri.parse(u.file.fileName):null);await this._libFiles.fetchLibFilesIfNecessary(g),!e.isDisposed()&&i.editor.setModelMarkers(e,this._selector,n.map(u=>this._convertDiagnostics(e,u)))}_convertDiagnostics(e,r){const s=r.start||0,a=r.length||1,{lineNumber:c,column:d}=e.getPositionAt(s),{lineNumber:p,column:n}=e.getPositionAt(s+a),g=[];return r.reportsUnnecessary&&g.push(i.MarkerTag.Unnecessary),r.reportsDeprecated&&g.push(i.MarkerTag.Deprecated),{severity:this._tsDiagnosticCategoryToMarkerSeverity(r.category),startLineNumber:c,startColumn:d,endLineNumber:p,endColumn:n,message:q(r.messageText,`
`),code:r.code.toString(),tags:g,relatedInformation:this._convertRelatedInformation(e,r.relatedInformation)}}_convertRelatedInformation(e,r){if(!r)return[];const s=[];return r.forEach(a=>{let c=e;if(a.file&&(c=this._libFiles.getOrCreateModel(a.file.fileName)),!c)return;const d=a.start||0,p=a.length||1,{lineNumber:n,column:g}=c.getPositionAt(d),{lineNumber:u,column:h}=c.getPositionAt(d+p);s.push({resource:c.uri,startLineNumber:n,startColumn:g,endLineNumber:u,endColumn:h,message:q(a.messageText,`
`)})}),s}_tsDiagnosticCategoryToMarkerSeverity(e){switch(e){case 1:return i.MarkerSeverity.Error;case 3:return i.MarkerSeverity.Info;case 0:return i.MarkerSeverity.Warning;case 2:return i.MarkerSeverity.Hint}return i.MarkerSeverity.Info}},f(O,"DiagnosticsAdapter"),O),A,U=(A=class extends S{get triggerCharacters(){return["."]}async provideCompletionItems(e,r,s,a){const c=e.getWordUntilPosition(r),d=new i.Range(r.lineNumber,c.startColumn,r.lineNumber,c.endColumn),p=e.uri,n=e.getOffsetAt(r),g=await this._worker(p);if(e.isDisposed())return;const u=await g.getCompletionsAtPosition(p.toString(),n);return!u||e.isDisposed()?void 0:{suggestions:u.entries.map(b=>{let m=d;if(b.replacementSpan){const k=e.getPositionAt(b.replacementSpan.start),B=e.getPositionAt(b.replacementSpan.start+b.replacementSpan.length);m=new i.Range(k.lineNumber,k.column,B.lineNumber,B.column)}const w=[];return b.kindModifiers?.indexOf("deprecated")!==-1&&w.push(i.languages.CompletionItemTag.Deprecated),{uri:p,position:r,offset:n,range:m,label:b.name,insertText:b.name,sortText:b.sortText,kind:U.convertKind(b.kind),tags:w}})}}async resolveCompletionItem(e,r){const s=e,a=s.uri,c=s.position,d=s.offset,n=await(await this._worker(a)).getCompletionEntryDetails(a.toString(),d,s.label);return n?{uri:a,position:c,label:n.name,kind:U.convertKind(n.kind),detail:v(n.displayParts),documentation:{value:U.createDocumentationString(n)}}:s}static convertKind(e){switch(e){case l.primitiveType:case l.keyword:return i.languages.CompletionItemKind.Keyword;case l.variable:case l.localVariable:return i.languages.CompletionItemKind.Variable;case l.memberVariable:case l.memberGetAccessor:case l.memberSetAccessor:return i.languages.CompletionItemKind.Field;case l.function:case l.memberFunction:case l.constructSignature:case l.callSignature:case l.indexSignature:return i.languages.CompletionItemKind.Function;case l.enum:return i.languages.CompletionItemKind.Enum;case l.module:return i.languages.CompletionItemKind.Module;case l.class:return i.languages.CompletionItemKind.Class;case l.interface:return i.languages.CompletionItemKind.Interface;case l.warning:return i.languages.CompletionItemKind.File}return i.languages.CompletionItemKind.Property}static createDocumentationString(e){let r=v(e.documentation);if(e.tags)for(const s of e.tags)r+=`

${ae(s)}`;return r}},f(A,"SuggestAdapter"),A);function ae(t){let e=`*@${t.name}*`;if(t.name==="param"&&t.text){const[r,...s]=t.text;e+=`\`${r.text}\``,s.length>0&&(e+=` — ${s.map(a=>a.text).join(" ")}`)}else Array.isArray(t.text)?e+=` — ${t.text.map(r=>r.text).join(" ")}`:t.text&&(e+=` — ${t.text}`);return e}f(ae,"tagToString");var E,oe=(E=class extends S{constructor(){super(...arguments),this.signatureHelpTriggerCharacters=["(",","]}static _toSignatureHelpTriggerReason(e){switch(e.triggerKind){case i.languages.SignatureHelpTriggerKind.TriggerCharacter:return e.triggerCharacter?e.isRetrigger?{kind:"retrigger",triggerCharacter:e.triggerCharacter}:{kind:"characterTyped",triggerCharacter:e.triggerCharacter}:{kind:"invoked"};case i.languages.SignatureHelpTriggerKind.ContentChange:return e.isRetrigger?{kind:"retrigger"}:{kind:"invoked"};case i.languages.SignatureHelpTriggerKind.Invoke:default:return{kind:"invoked"}}}async provideSignatureHelp(e,r,s,a){const c=e.uri,d=e.getOffsetAt(r),p=await this._worker(c);if(e.isDisposed())return;const n=await p.getSignatureHelpItems(c.toString(),d,{triggerReason:oe._toSignatureHelpTriggerReason(a)});if(!n||e.isDisposed())return;const g={activeSignature:n.selectedItemIndex,activeParameter:n.argumentIndex,signatures:[]};return n.items.forEach(u=>{const h={label:"",parameters:[]};h.documentation={value:v(u.documentation)},h.label+=v(u.prefixDisplayParts),u.parameters.forEach((b,m,w)=>{const k=v(b.displayParts),B={label:k,documentation:{value:v(b.documentation)}};h.label+=k,h.parameters.push(B),m<w.length-1&&(h.label+=v(u.separatorDisplayParts))}),h.label+=v(u.suffixDisplayParts),g.signatures.push(h)}),{value:g,dispose(){}}}},f(E,"SignatureHelpAdapter"),E),F,xe=(F=class extends S{async provideHover(e,r,s){const a=e.uri,c=e.getOffsetAt(r),d=await this._worker(a);if(e.isDisposed())return;const p=await d.getQuickInfoAtPosition(a.toString(),c);if(!p||e.isDisposed())return;const n=v(p.documentation),g=p.tags?p.tags.map(h=>ae(h)).join(`  

`):"",u=v(p.displayParts);return{range:this._textSpanToRange(e,p.textSpan),contents:[{value:"```typescript\n"+u+"\n```\n"},{value:n+(g?`

`+g:"")}]}}},f(F,"QuickInfoAdapter"),F),P,Ce=(P=class extends S{async provideDocumentHighlights(e,r,s){const a=e.uri,c=e.getOffsetAt(r),d=await this._worker(a);if(e.isDisposed())return;const p=await d.getOccurrencesAtPosition(a.toString(),c);if(!(!p||e.isDisposed()))return p.map(n=>({range:this._textSpanToRange(e,n.textSpan),kind:n.isWriteAccess?i.languages.DocumentHighlightKind.Write:i.languages.DocumentHighlightKind.Text}))}},f(P,"OccurrencesAdapter"),P),N,Le=(N=class extends S{constructor(e,r){super(r),this._libFiles=e}async provideDefinition(e,r,s){const a=e.uri,c=e.getOffsetAt(r),d=await this._worker(a);if(e.isDisposed())return;const p=await d.getDefinitionAtPosition(a.toString(),c);if(!p||e.isDisposed()||(await this._libFiles.fetchLibFilesIfNecessary(p.map(g=>i.Uri.parse(g.fileName))),e.isDisposed()))return;const n=[];for(let g of p){const u=this._libFiles.getOrCreateModel(g.fileName);u&&n.push({uri:u.uri,range:this._textSpanToRange(u,g.textSpan)})}return n}},f(N,"DefinitionAdapter"),N),T,De=(T=class extends S{constructor(e,r){super(r),this._libFiles=e}async provideReferences(e,r,s,a){const c=e.uri,d=e.getOffsetAt(r),p=await this._worker(c);if(e.isDisposed())return;const n=await p.getReferencesAtPosition(c.toString(),d);if(!n||e.isDisposed()||(await this._libFiles.fetchLibFilesIfNecessary(n.map(u=>i.Uri.parse(u.fileName))),e.isDisposed()))return;const g=[];for(let u of n){const h=this._libFiles.getOrCreateModel(u.fileName);h&&g.push({uri:h.uri,range:this._textSpanToRange(h,u.textSpan)})}return g}},f(T,"ReferenceAdapter"),T),I,Oe=(I=class extends S{async provideDocumentSymbols(e,r){const s=e.uri,a=await this._worker(s);if(e.isDisposed())return;const c=await a.getNavigationBarItems(s.toString());if(!c||e.isDisposed())return;const d=f((n,g,u)=>{let h={name:g.text,detail:"",kind:_[g.kind]||i.languages.SymbolKind.Variable,range:this._textSpanToRange(e,g.spans[0]),selectionRange:this._textSpanToRange(e,g.spans[0]),tags:[]};if(u&&(h.containerName=u),g.childItems&&g.childItems.length>0)for(let b of g.childItems)d(n,b,h.name);n.push(h)},"convert");let p=[];return c.forEach(n=>d(p,n)),p}},f(I,"OutlineAdapter"),I),M,l=(M=class{},f(M,"Kind"),M);l.unknown="";l.keyword="keyword";l.script="script";l.module="module";l.class="class";l.interface="interface";l.type="type";l.enum="enum";l.variable="var";l.localVariable="local var";l.function="function";l.localFunction="local function";l.memberFunction="method";l.memberGetAccessor="getter";l.memberSetAccessor="setter";l.memberVariable="property";l.constructorImplementation="constructor";l.callSignature="call";l.indexSignature="index";l.constructSignature="construct";l.parameter="parameter";l.typeParameter="type parameter";l.primitiveType="primitive type";l.label="label";l.alias="alias";l.const="const";l.let="let";l.warning="warning";var _=Object.create(null);_[l.module]=i.languages.SymbolKind.Module;_[l.class]=i.languages.SymbolKind.Class;_[l.enum]=i.languages.SymbolKind.Enum;_[l.interface]=i.languages.SymbolKind.Interface;_[l.memberFunction]=i.languages.SymbolKind.Method;_[l.memberVariable]=i.languages.SymbolKind.Property;_[l.memberGetAccessor]=i.languages.SymbolKind.Property;_[l.memberSetAccessor]=i.languages.SymbolKind.Property;_[l.variable]=i.languages.SymbolKind.Variable;_[l.const]=i.languages.SymbolKind.Variable;_[l.localVariable]=i.languages.SymbolKind.Variable;_[l.variable]=i.languages.SymbolKind.Variable;_[l.function]=i.languages.SymbolKind.Function;_[l.localFunction]=i.languages.SymbolKind.Function;var R,y=(R=class extends S{static _convertOptions(e){return{ConvertTabsToSpaces:e.insertSpaces,TabSize:e.tabSize,IndentSize:e.tabSize,IndentStyle:2,NewLineCharacter:`
`,InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,PlaceOpenBraceOnNewLineForFunctions:!1}}_convertTextChanges(e,r){return{text:r.newText,range:this._textSpanToRange(e,r.span)}}},f(R,"FormatHelper"),R),H,Ae=(H=class extends y{async provideDocumentRangeFormattingEdits(e,r,s,a){const c=e.uri,d=e.getOffsetAt({lineNumber:r.startLineNumber,column:r.startColumn}),p=e.getOffsetAt({lineNumber:r.endLineNumber,column:r.endColumn}),n=await this._worker(c);if(e.isDisposed())return;const g=await n.getFormattingEditsForRange(c.toString(),d,p,y._convertOptions(s));if(!(!g||e.isDisposed()))return g.map(u=>this._convertTextChanges(e,u))}},f(H,"FormatAdapter"),H),W,Ee=(W=class extends y{get autoFormatTriggerCharacters(){return[";","}",`
`]}async provideOnTypeFormattingEdits(e,r,s,a,c){const d=e.uri,p=e.getOffsetAt(r),n=await this._worker(d);if(e.isDisposed())return;const g=await n.getFormattingEditsAfterKeystroke(d.toString(),p,s,y._convertOptions(a));if(!(!g||e.isDisposed()))return g.map(u=>this._convertTextChanges(e,u))}},f(W,"FormatOnTypeAdapter"),W),V,Fe=(V=class extends y{async provideCodeActions(e,r,s,a){const c=e.uri,d=e.getOffsetAt({lineNumber:r.startLineNumber,column:r.startColumn}),p=e.getOffsetAt({lineNumber:r.endLineNumber,column:r.endColumn}),n=y._convertOptions(e.getOptions()),g=s.markers.filter(m=>m.code).map(m=>m.code).map(Number),u=await this._worker(c);if(e.isDisposed())return;const h=await u.getCodeFixesAtPosition(c.toString(),d,p,g,n);return!h||e.isDisposed()?{actions:[],dispose:()=>{}}:{actions:h.filter(m=>m.changes.filter(w=>w.isNewFile).length===0).map(m=>this._tsCodeFixActionToMonacoCodeAction(e,s,m)),dispose:()=>{}}}_tsCodeFixActionToMonacoCodeAction(e,r,s){const a=[];for(const d of s.changes)for(const p of d.textChanges)a.push({resource:e.uri,edit:{range:this._textSpanToRange(e,p.span),text:p.newText}});return{title:s.description,edit:{edits:a},diagnostics:r.markers,kind:"quickfix"}}},f(V,"CodeActionAdaptor"),V),K,Pe=(K=class extends S{constructor(e,r){super(r),this._libFiles=e}async provideRenameEdits(e,r,s,a){const c=e.uri,d=c.toString(),p=e.getOffsetAt(r),n=await this._worker(c);if(e.isDisposed())return;const g=await n.getRenameInfo(d,p,{allowRenameOfImportPath:!1});if(g.canRename===!1)return{edits:[],rejectReason:g.localizedErrorMessage};if(g.fileToRename!==void 0)throw new Error("Renaming files is not supported.");const u=await n.findRenameLocations(d,p,!1,!1,!1);if(!u||e.isDisposed())return;const h=[];for(const b of u){const m=this._libFiles.getOrCreateModel(b.fileName);if(m)h.push({resource:m.uri,edit:{range:this._textSpanToRange(m,b.textSpan),text:s}});else throw new Error(`Unknown file ${b.fileName}.`)}return{edits:h}}},f(K,"RenameAdapter"),K),j,Ne=(j=class extends S{async provideInlayHints(e,r,s){const a=e.uri,c=a.toString(),d=e.getOffsetAt({lineNumber:r.startLineNumber,column:r.startColumn}),p=e.getOffsetAt({lineNumber:r.endLineNumber,column:r.endColumn}),n=await this._worker(a);return e.isDisposed()?[]:(await n.provideInlayHints(c,d,p)).map(u=>({...u,position:e.getPositionAt(u.position),kind:this._convertHintKind(u.kind)}))}_convertHintKind(e){switch(e){case"Parameter":return i.languages.InlayHintKind.Parameter;case"Type":return i.languages.InlayHintKind.Type;default:return i.languages.InlayHintKind.Other}}},f(j,"InlayHintsAdapter"),j),Y,Z;function Te(t){Z=le(t,"typescript")}f(Te,"setupTypeScript");function Ie(t){Y=le(t,"javascript")}f(Ie,"setupJavaScript");function Me(){return new Promise((t,e)=>{if(!Y)return e("JavaScript not registered!");t(Y)})}f(Me,"getJavaScriptWorker2");function Re(){return new Promise((t,e)=>{if(!Z)return e("TypeScript not registered!");t(Z)})}f(Re,"getTypeScriptWorker2");function le(t,e){const r=new me(e,t),s=f((...c)=>r.getLanguageServiceWorker(...c),"worker"),a=new ye(s);return i.languages.registerCompletionItemProvider(e,new U(s)),i.languages.registerSignatureHelpProvider(e,new oe(s)),i.languages.registerHoverProvider(e,new xe(s)),i.languages.registerDocumentHighlightProvider(e,new Ce(s)),i.languages.registerDefinitionProvider(e,new Le(a,s)),i.languages.registerReferenceProvider(e,new De(a,s)),i.languages.registerDocumentSymbolProvider(e,new Oe(s)),i.languages.registerDocumentRangeFormattingEditProvider(e,new Ae(s)),i.languages.registerOnTypeFormattingEditProvider(e,new Ee(s)),i.languages.registerCodeActionProvider(e,new Fe(s)),i.languages.registerRenameProvider(e,new Pe(a,s)),i.languages.registerInlayHintsProvider(e,new Ne(s)),new ke(a,t,e,s),s}f(le,"setupMode");const He=Object.freeze(Object.defineProperty({__proto__:null,getJavaScriptWorker:Me,getTypeScriptWorker:Re,setupJavaScript:Ie,setupTypeScript:Te},Symbol.toStringTag,{value:"Module"}));export{Me as getJavaScriptWorker,Re as getTypeScriptWorker,Ie as setupJavaScript,Te as setupTypeScript};
//# sourceMappingURL=tsMode-c6ec1b71.js.map
